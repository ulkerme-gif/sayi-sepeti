<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>SayÄ± Sepeti - Mete ÃœLKER</title>
<style>
/*-----------------------------------*/
/* TEMEL STÄ°LLER                     */
/*-----------------------------------*/
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:Arial,sans-serif;display:flex;flex-direction:column;align-items:center;background:#87CEEB;}
#info{width:400px;text-align:center;margin-top:10px;color:#222;}
canvas{border:3px solid #ff9800;margin-top:10px;background:transparent;}
.floating{position:absolute;left:50%;transform:translateX(-50%);font-weight:700;pointer-events:none;}
</style>
</head>
<body>
<div id="info">
  <h2>ðŸŽ¯ SayÄ± Sepeti</h2>
  <div>Yapan: <strong>Mete ÃœLKER</strong></div>
  <p>AÅŸama: <span id="level">1</span> | Puan: <span id="score">0</span></p>
</div>
<canvas id="game" width="400" height="500"></canvas>

<script>
/*-----------------------------------*/
/*  SABÄ°TLER VE DEÄžÄ°ÅžKENLER          */
/*-----------------------------------*/
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;
const GROUND_Y = 450;

let sepet = {x:170,y:420,w:60,h:30};
let score=0, level=1, speed=3;
let gameActive=false, startScreen=true, gameOver=false, levelScreen=false;

let numbers=[], blackBalls=[];
let effects = {greenPulses:[],redShake:0,levelBursts:[],skyPhase:0};
let waveInProgress=false;

/*-----------------------------------*/
/*  YARDIMCI FONKSÄ°YONLAR            */
/*-----------------------------------*/
function randomInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
function randomXAvoid(existing){
  let x, tries=0;
  do{x=randomInt(20,W-20); tries++;}while(existing.some(p=>Math.abs(p-x)<60)&&tries<50);
  return x;
}
function rasyonelSayi(min=-2,max=2){
  const paydaList=[2,3,4];
  const pay=randomInt(min,max)||1;
  const payda=paydaList[randomInt(0,paydaList.length-1)];
  return pay+"/"+payda;
}

/*-----------------------------------*/
/*  OYUN SAYILARI ÃœRETME             */
/*-----------------------------------*/
function generateNumber(index){
  let s={x:0,y:-30,deger:null,tip:null,dogru:false};
  s.x=randomXAvoid(numbers.map(n=>n.x).concat(blackBalls.map(b=>b.x)));
  if(level===1){
    if(index===0){s.deger=randomInt(0,9); s.tip='dogal'; s.dogru=true;}
    else{ if(Math.random()<0.5){s.deger=-randomInt(1,9); s.tip='negatif';}else{s.deger=rasyonelSayi(); s.tip='rasyonel';} s.dogru=false; }
  }else if(level===2){
    if(index===0){s.deger=randomInt(-10,10); s.tip='tam'; s.dogru=true;}
    else{s.deger=rasyonelSayi(); s.tip='rasyonel'; s.dogru=false;}
  }else{
    s.deger=rasyonelSayi(); s.tip='rasyonel'; s.dogru=true;
  }
  return s;
}

function generateWave(){
  if(waveInProgress || !gameActive) return;
  waveInProgress=true;
  numbers=[]; blackBalls=[];
  numbers.push(generateNumber(0));
  setTimeout(()=>{ if(gameActive){ numbers.push(generateNumber(1)); } },1000);

  const blackCount = (level===3?2:1);
  for(let i=0;i<blackCount;i++){
    setTimeout(()=>{
      if(!gameActive) return;
      let bX=randomXAvoid(numbers.map(n=>n.x).concat(blackBalls.map(b=>b.x)));
      blackBalls.push({x:bX,y:-20,r:16});
    },500+i*100);
  }
  setTimeout(()=>{ waveInProgress=false; },1500);
}

/*-----------------------------------*/
/*  EFEKT FONKSÄ°YONLARI              */
/*-----------------------------------*/
function addGreenPulse(x,y){ effects.greenPulses.push({x,y,r:8,maxR:60,alpha:1}); }
function addLevelBurst(x,y){ effects.levelBursts.push({x,y,r:10,maxR:120,alpha:1}); }
function triggerRedShake(ms=200){ effects.redShake=Math.max(effects.redShake,ms); }

/*-----------------------------------*/
/*  GÃ–KYÃœZÃœ VE SAHNE Ã‡Ä°ZÄ°M           */
/*-----------------------------------*/
const skyColors={1:{from:'#bfe9ff',to:'#87CEEB'},2:{from:'#87CEEB',to:'#66b3ff'},3:{from:'#ffcc99',to:'#ff9966'}};
function drawStars(alpha){
  ctx.save(); ctx.globalAlpha=alpha;
  for(let i=0;i<60;i++){ const sx=Math.random()*W; const sy=Math.random()*H*0.6; const s=Math.random()*2; ctx.fillStyle='white'; ctx.fillRect(sx,sy,s,s);}
  ctx.restore();
}

function drawScene(){
  const speedPhase=0.0003*(1+level*0.6);
  effects.skyPhase=(effects.skyPhase+speedPhase)%1;
  const sc=skyColors[Math.min(level,3)];
  const g=ctx.createLinearGradient(0,0,0,H); g.addColorStop(0,sc.from); g.addColorStop(1,sc.to);
  ctx.fillStyle=g; ctx.fillRect(0,0,W,H);

  if(startScreen){ drawStartScreen(); return; }
  if(levelScreen){ drawLevelScreen(); return; }
  if(gameOver){ drawGameOverScreen(); return; }

  ctx.fillStyle='#8B4513'; ctx.fillRect(0,GROUND_Y,W,H-GROUND_Y);

  let shakeOffset=0;
  if(effects.redShake>0){ shakeOffset=(Math.sin(Date.now()/30)*4); }

  ctx.fillStyle='#FF8C00';
  ctx.fillRect(sepet.x+shakeOffset,sepet.y,sepet.w,sepet.h);
  ctx.fillStyle='#FFB74D'; ctx.fillRect(sepet.x-5+shakeOffset,sepet.y-15,sepet.w+10,10);

  ctx.font="28px Arial"; ctx.textBaseline='middle';
  numbers.forEach(s=>{ ctx.fillStyle=(s.tip==='rasyonel')?'#00695c':'#1565c0'; ctx.fillText(String(s.deger),s.x,s.y); });
  blackBalls.forEach(t=>{ ctx.fillStyle='black'; ctx.beginPath(); ctx.arc(t.x,t.y,t.r,0,Math.PI*2); ctx.fill(); });

  effects.greenPulses.forEach(p=>{ ctx.beginPath(); ctx.fillStyle=`rgba(0,200,0,${p.alpha*0.4})`; ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill(); });
  effects.levelBursts.forEach(b=>{ ctx.beginPath(); ctx.strokeStyle=`rgba(255,220,100,${b.alpha})`; ctx.lineWidth=3; ctx.arc(b.x,b.y,b.r,0,Math.PI*2); ctx.stroke(); });
}

/*-----------------------------------*/
/*  EKRAN FONKSÄ°YONLARI             */
/*-----------------------------------*/
function drawStartScreen(){
  ctx.fillStyle='rgba(0,0,60,0.6)'; ctx.fillRect(0,0,W,H);
  ctx.fillStyle='white'; ctx.font='24px Arial'; ctx.textAlign='center'; ctx.fillText('Oyuna baÅŸlamak iÃ§in tÄ±klayÄ±n / dokunun', W/2,H/2);
}

function drawLevelScreen(){
  ctx.fillStyle='rgba(0,0,60,0.6)'; ctx.fillRect(0,0,W,H);
  ctx.fillStyle='white'; ctx.font='24px Arial'; ctx.textAlign='center';
  let levelText = '';
  if(level===1) levelText='AÅŸama 1: DoÄŸal sayÄ±lar';
  else if(level===2) levelText='AÅŸama 2: Tam sayÄ±lar';
  else levelText='AÅŸama 3: Rasyonel sayÄ±lar';
  ctx.fillText(levelText + ', baÅŸlamak iÃ§in dokunun', W/2,H/2);
}

function drawGameOverScreen(){
  ctx.fillStyle='rgba(0,0,60,0.6)'; ctx.fillRect(0,0,W,H);
  ctx.fillStyle='white'; ctx.font='24px Arial'; ctx.textAlign='center';
  ctx.fillText('Tebrikler! Oyunu kazandÄ±nÄ±z. Tekrar oynamak iÃ§in dokunun', W/2,H/2);
}

/*-----------------------------------*/
/*  OYUN GÃœNCELLEME                  */
/*-----------------------------------*/
function update(){
  if(effects.redShake>0){ effects.redShake-=16; if(effects.redShake<0) effects.redShake=0; }
  effects.greenPulses.forEach(p=>{ p.r+=5; p.alpha-=0.06; });
  effects.greenPulses=effects.greenPulses.filter(p=>p.alpha>0 && p.r<p.maxR);
  effects.levelBursts.forEach(b=>{ b.r+=8; b.alpha-=0.04; });
  effects.levelBursts=effects.levelBursts.filter(b=>b.alpha>0 && b.r<b.maxR);

  if(!gameActive) return;

  numbers.forEach(s=>s.y+=speed);
  blackBalls.forEach(t=>t.y+=speed);

  for(let i=numbers.length-1;i>=0;i--){
    const s=numbers[i];
    if(s.y>sepet.y-18 && s.x>sepet.x-8 && s.x<sepet.x+sepet.w+8){
      if(s.tip==='rasyonel' && level<3){ score-=10; triggerRedShake(); if(score<0){ resetGame(); return; } }
      else if(s.dogru){ score+=10; addGreenPulse(sepet.x+sepet.w/2,sepet.y); }
      else { triggerRedShake(); }
      numbers.splice(i,1);
    } else if(s.y>GROUND_Y+10){ numbers.splice(i,1); }
  }

  for(let i=blackBalls.length-1;i>=0;i--){
    const t=blackBalls[i];
    if(t.y>sepet.y-8 && t.x>sepet.x-8 && t.x<sepet.x+sepet.w+8){ score-=10; triggerRedShake(); if(score<0){ resetGame(); return; } blackBalls.splice(i,1);}
    else if(t.y>GROUND_Y+10){ blackBalls.splice(i,1);}
  }

  if(numbers.length===0 && blackBalls.length===0 && gameActive){ setTimeout(generateWave,600); }

  if(score>=60){
    score=0; level++;
    if(level
